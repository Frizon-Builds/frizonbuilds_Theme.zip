"use strict";(self.webpackChunk_SK=self.webpackChunk_SK||[]).push([["app_components_Autocomplete_Autocomplete_tsx"],{"./app/components/Autocomplete/Autocomplete.tsx":(e,t,o)=>{o.d(t,{F:()=>z});var n=o("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js"),s=o.n(n),i=o("./node_modules/react/index.js"),l=o("./node_modules/@shopify/polaris/build/esnext/components/Banner/Banner.esnext"),r=o("./node_modules/@shopify/polaris/build/esnext/components/TextField/TextField.esnext"),p=o("./node_modules/@shopify/polaris/build/esnext/components/Spinner/Spinner.esnext"),c=o("./node_modules/@shopify/polaris/build/esnext/components/Popover/Popover.esnext"),a=o("./node_modules/@shopify/polaris/build/esnext/types.esnext"),d=o("./packages/@web-utilities/id/index.ts"),u=o("./packages/@web-utilities/decorators/index.ts"),h=o("./node_modules/lodash-decorators/index.js");function m(e,t,o){return e.length===t.length&&e.every(((e,n)=>{const s=t[n];return null!=o?o(e,s):e===s}))}const y=(0,o("./node_modules/@shopify/react-async/build/esnext/component.esnext").L)({load:()=>Promise.all([o.e("vendors-node_modules_react-virtualized_dist_es_index_js"),o.e("VirtualizedOptionsList")]).then(o.bind(o,"./app/components/Autocomplete/components/OptionsList/VirtualizedOptionsList.tsx")),id:()=>"./app/components/Autocomplete/components/OptionsList/VirtualizedOptionsList.tsx"});var f=o("./node_modules/@babel/runtime/helpers/extends.js"),b=o.n(f),g=o("./node_modules/classnames/index.js"),O=o.n(g),x=o("./app/components/Autocomplete/components/OptionsList/components/Option/Option.tsx"),v=o("./app/components/Autocomplete/components/OptionsList/utilities.ts");const C="NYjpU",S="Oyydb",w="iwfOJ",E="ZYkQH",j="OL86j";var N;const D=(0,d.H)("OptionsList");let k=(N=class extends i.Component{constructor(...e){super(...e),this.state={normalizedOptions:(0,v.aH)(this.props.options,this.props.sections,this.props.title)},this.id=this.props.id||D()}UNSAFE_componentWillReceiveProps({options:e=[],sections:t=[],id:o,title:n,focusedIndex:s}){const{options:i=[],sections:l=[],id:r,title:p,focusedIndex:c,onScrollTo:a}=this.props;r!==o&&(this.id=o||this.id);const d=!m(e,i),u=!m(t,l,A);(d||u||p!==n)&&this.setState({normalizedOptions:(0,v.aH)(e,t,n)}),a&&0===s&&0!==c&&setTimeout((()=>a(0,0)),0)}render(){const{normalizedOptions:e}=this.state,{selected:t,allowMultiple:o,renderSpecialOption:n,onSpecialOptionClick:s,focusedIndex:l,onScrollTo:r}=this.props,p=e.length>0,c=n&&n(),a=(0,v.hA)(l,e,Boolean(c)),d=c?i.createElement("button",{type:"button",key:"action",className:O()(E,"specialOption"===a&&j),onMouseDown:e=>0===e.button?e.preventDefault():null,onClick:s},c):null,{optionIndex:u,sectionIndex:h}=a&&"specialOption"!==a?a:{optionIndex:null,sectionIndex:null},m=p?e.map((({title:e,options:n},s)=>{const l=e?i.createElement("p",{className:w},e):null,p=n.map(((e,n)=>{const l=`${this.id}-${s}-${n}`,p=t.includes(e.value),c=n===u&&s===h;return i.createElement(x.W,b()({key:l},e,{id:l,section:s,index:n,onClick:this.handleClick,select:p,allowMultiple:o,focused:c,onScrollTo:r}))}));return i.createElement("li",{key:e||`noTitle-${s}`,className:S},l,i.createElement("ul",{className:S},p))})):null;return i.createElement("ul",{className:C},d,m)}handleClick(e,t){const{selected:o,onChange:n,allowMultiple:s}=this.props,{normalizedOptions:i}=this.state,l=i[e].options[t].value;if(s){n((0,v._C)(l,o))}else n([l])}},s()(N.prototype,"handleClick",[u.Nj],Object.getOwnPropertyDescriptor(N.prototype,"handleClick"),N.prototype),N);function A(e,t){const{options:o}=e,{options:n}=t,s=m(o,n),i=e.title===t.title;return s&&i}const F="bwvdK",I="i3L6G",_="yF43F",L="Igj_Y";var R,T,M;const P=(0,d.H)("Autocomplete"),W=-1;let z=(R=(0,h.debounce)(1e3,{leading:!0}),T=(0,h.debounce)(1e3,{leading:!0}),M=class extends i.Component{constructor(...e){super(...e),this.state={hovered:!1,focusedIndex:W,options:this.createOptions(this.props.options),sections:this.createSections(this.props.sections)},this.disclosureWrapper=null,this.scrollContainer=null,this.textFieldInput=null,this.connectedRightNode=void 0,this.id=this.props.id||P(),this.ignoreFocus=!1,this.popoverRef=(0,i.createRef)()}componentDidMount(){this.setAccessibleAttributes()}componentDidUpdate(){const{showDisclosure:e,virtualized:t}=this.props;this.setAccessibleAttributes(),!t&&null==this.scrollContainer&&e&&null!=this.disclosureWrapper&&(this.scrollContainer=this.disclosureWrapper.parentElement||this.disclosureWrapper,this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll,{passive:!0})),e||this.removeScrollEventListener()}UNSAFE_componentWillReceiveProps({id:e,options:t=[],sections:o=[],value:n}){const{id:s,options:i=[],sections:l=[],value:r}=this.props;s!==e&&(this.id=e||this.id);const p=!m(t,i),c=!m(o,l,K),a=n!==r;this.setState((({options:e,sections:n,focusedIndex:s})=>({options:p?this.createOptions(t):e,sections:c?this.createSections(o):n,focusedIndex:a?W:s})))}componentWillUnmount(){this.removeScrollEventListener()}setConnectedRightWrapper(e){this.connectedRightNode=e}render(){const{label:e,id:t,labelHidden:o,connectedRight:n,loading:s=!1,showDisclosure:a=!1,disabled:d=!1,placeholder:u,value:h="",prefix:m,suffix:f,renderEmptyState:b,helpText:g,title:O,selected:x,allowMultiple:v,name:C,onChange:S,onClose:w=U,renderAction:E,willLoadMoreResults:j,fullWidth:N,error:D,warning:A,virtualized:R,type:T,showCharacterCount:M=!1,maxLength:P,preferInputActivator:W}=this.props,{options:z,sections:H,focusedIndex:K}=this.state,$=A?i.createElement("div",{className:L},i.createElement(l.j,{status:"warning"},A)):null,V=i.createElement("div",{onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,ref:this.setTextFieldInputElement},i.createElement(r.n,{name:C,type:T,id:t,label:e,labelHidden:o,connectedRight:this.props.connectedRight&&i.createElement("span",{ref:this.setConnectedRightWrapper},n),disabled:d,placeholder:u,value:h,prefix:m,suffix:f,onChange:S,onFocus:this.handleFocus,error:D,autoComplete:"off",helpText:g,maxLength:P,showCharacterCount:M})),G=!j&&s?i.createElement("div",{key:"LoadingState",className:I},i.createElement(p.$,{size:"small"})):null,J=Boolean(E&&E()),Y=B(z,H),Z=R&&a?i.createElement(y.Preload,null):null,q=R?i.createElement(y,{id:null==this.id?void 0:`${this.id}-options`,title:O,options:z,sections:H,selected:x||[],onChange:this.handleOptionSelect,allowMultiple:v,renderSpecialOption:E,onSpecialOptionClick:this.handleSpecialOptionClick,collectionKey:h,onScroll:this.handleVirtualizedScroll,onResize:this.handleListResize,focusedIndex:K}):i.createElement(k,{id:null==this.id?void 0:`${this.id}-options`,title:O,options:z,sections:H,selected:x||[],onChange:this.handleOptionSelect,allowMultiple:v,renderSpecialOption:E,onSpecialOptionClick:this.handleSpecialOptionClick,focusedIndex:K,onScrollTo:this.handleScrollTo}),Q=J||Y?q:null,X=null==b||Y||s?null:i.createElement("div",{key:"EmptyState",className:F},b()),ee=j?i.createElement("div",{className:_},i.createElement(p.$,{size:"small"})):null;return i.createElement(i.Fragment,null,$,i.createElement(c.J,{ref:this.popoverRef,active:this.showPopover(),activator:V,onClose:w,fullWidth:null==N||N,autofocusTarget:"none",fullHeight:R,preferInputActivator:W},i.createElement("div",{id:`${this.id}-disclosure`,"aria-expanded":a,ref:this.setDisclosureWrapper,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},Q,G,X,ee)),Z)}handleOptionSelect(e){this.props.onSelect(e),this.props.allowMultiple&&this.popoverRef.current?.forceUpdatePosition()}removeScrollEventListener(){null!=this.scrollContainer&&(this.scrollContainer.removeEventListener("scroll",this.handleScroll),this.scrollContainer=null)}showPopover(){const{showDisclosure:e,renderEmptyState:t,loading:o,renderAction:n}=this.props;if(!e)return!1;const{options:s,sections:i}=this.state;return!!(t||o||B(s,i)||n&&n())}setAccessibleAttributes(){const{textFieldInput:e}=this;if(null==e)return;const{showDisclosure:t=!1}=this.props;e.setAttribute("aria-autocomplete","list"),e.setAttribute("role","combobox"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-expanded",`${t}`),e.setAttribute("aria-controls",`${this.id}-disclosure`)}handleKeyDown(e){const{hovered:t,focusedIndex:o}=this.state,{onKeyDown:n,allowMultiple:s,onClose:i}=this.props,{keyCode:l}=e;if(l===a.s.Enter&&e.preventDefault(),!t)switch(l){case a.s.DownArrow:this.shiftFocus(1);break;case a.s.UpArrow:this.shiftFocus(-1);break;case a.s.Enter:o!==W&&(this.selectFocused(),!s&&i&&i())}n&&o===W&&n(e)}shiftFocus(e){const{focusedIndex:t}=this.state,o=Math.min(Math.max(0,t+e),this.totalFocusableRowCount-1);this.setState({focusedIndex:o})}selectFocused(){const{options:e,sections:t,focusedIndex:o}=this.state,{renderAction:n,onActionSelect:s,selected:i=[],allowMultiple:l}=this.props,r=Boolean(n&&n());if(0===o&&r)return void(s&&s());const p=function(e,t,o){if(e<0)return null;if(e<t.length)return t[e].value;let n=e-t.length;for(let e=0;e<o.length;++e){const t=o[e].options.length;if(n<t)return o[e].options[n].value;n-=t}return null}(o-(r?1:0),e,t);null!==p&&this.handleOptionSelect(l?(0,v._C)(p,i):[p])}handleMouseEnter(){this.setState({hovered:!0,focusedIndex:W})}handleMouseLeave(){this.setState({hovered:!1})}handleScrollTo(e,t){if(!this.scrollContainer)return;const{scrollTop:o,clientHeight:n}=this.scrollContainer,s=e+t,i=o+n;e<o?this.scrollTo(e):s>i&&this.scrollTo(o+(s-i))}handleScroll(){const{onLoadMoreResults:e}=this.props,{scrollContainer:t}=this;null!=e&&null!=t&&t.scrollTop>t.scrollHeight-2*t.offsetHeight&&e()}handleVirtualizedScroll(e){const{onLoadMoreResults:t}=this.props,{scrollTop:o,scrollHeight:n,clientHeight:s}=e;t&&o>n-2*s&&t()}handleListResize(){this.forceUpdate()}setTextFieldInputElement(e){const t=e?e.querySelector("input"):null;this.textFieldInput=t}setDisclosureWrapper(e){this.disclosureWrapper=e}handleFocus(){if(this.ignoreFocus)return void(this.ignoreFocus=!1);const{onFocus:e}=this.props;e&&e()}handleBlur(e){const{onClose:t,allowMultiple:o,virtualized:n,onBlur:s}=this.props,i=e.target,l=e.relatedTarget,r=this.connectedRightNode&&this.connectedRightNode.contains(l),p=this.connectedRightNode&&this.connectedRightNode.contains(i),c=l&&this.disclosureWrapper&&(n?l.scrollHeight>l.clientHeight:l.contains(this.disclosureWrapper)),a=o||n||this.disclosureWrapper&&this.disclosureWrapper.contains(l);if(c&&i)return this.ignoreFocus=!0,void i.focus();r||a||p&&null==l||(s&&(this.setState({focusedIndex:W,hovered:!1}),s()),t&&(this.setState({focusedIndex:W,hovered:!1}),t()))}handleSpecialOptionClick(){const{onActionSelect:e=U}=this.props;e(),this.textFieldInput?.blur()}createOptions(e){if(null==e)return[];if(e.every(H))return e;const{idForOption:t=$,labelForOption:o=$,isOptionDisabled:n}=this.props;return e.map((e=>({value:t(e),label:o(e),disabled:n&&n(e)})))}createSections(e){return null==e?[]:e.map((({title:e,options:t})=>({title:e,options:this.createOptions(t)})))}get totalFocusableRowCount(){const{options:e,sections:t}=this.state,{renderAction:o}=this.props,n=Boolean(o&&o()),s=t.reduce(((e,t)=>e+t.options.length),0);return e.length+s+(n?1:0)}scrollTo(e){setTimeout((()=>{this.scrollContainer&&(this.scrollContainer.scrollTop=e)}),0)}},s()(M.prototype,"setConnectedRightWrapper",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"setConnectedRightWrapper"),M.prototype),s()(M.prototype,"handleOptionSelect",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleOptionSelect"),M.prototype),s()(M.prototype,"handleKeyDown",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleKeyDown"),M.prototype),s()(M.prototype,"handleMouseEnter",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleMouseEnter"),M.prototype),s()(M.prototype,"handleMouseLeave",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleMouseLeave"),M.prototype),s()(M.prototype,"handleScrollTo",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleScrollTo"),M.prototype),s()(M.prototype,"handleScroll",[u.Nj,R],Object.getOwnPropertyDescriptor(M.prototype,"handleScroll"),M.prototype),s()(M.prototype,"handleVirtualizedScroll",[u.Nj,T],Object.getOwnPropertyDescriptor(M.prototype,"handleVirtualizedScroll"),M.prototype),s()(M.prototype,"handleListResize",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleListResize"),M.prototype),s()(M.prototype,"setTextFieldInputElement",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"setTextFieldInputElement"),M.prototype),s()(M.prototype,"setDisclosureWrapper",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"setDisclosureWrapper"),M.prototype),s()(M.prototype,"handleFocus",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleFocus"),M.prototype),s()(M.prototype,"handleBlur",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleBlur"),M.prototype),s()(M.prototype,"handleSpecialOptionClick",[u.Nj],Object.getOwnPropertyDescriptor(M.prototype,"handleSpecialOptionClick"),M.prototype),M);function H(e){return"string"==typeof e.value&&"string"==typeof e.label&&(null==e.disabled||"boolean"==typeof e.disabled)}function B(e=[],t=[]){const o=t.reduce(((e,{options:t})=>e+t.length),0);return e.length+o>0}function K(e,t){const{options:o}=e,{options:n}=t,s=m(o,n),i=e.title===t.title;return s&&i}function $(e){if(null==e.toString)throw new Error("Autocomplete props `idForOption` and `labelForOption` must be defined for custom options or sections, or option must be stringable");return e.toString()}function U(){}},"./app/components/Autocomplete/components/OptionsList/components/Option/Option.tsx":(e,t,o)=>{o.d(t,{W:()=>b});var n=o("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js"),s=o.n(n),i=o("./node_modules/react/index.js"),l=o("./packages/@web-utilities/decorators/index.ts"),r=o("./node_modules/classnames/index.js"),p=o.n(r),c=o("./node_modules/@shopify/polaris/build/esnext/components/Checkbox/Checkbox.esnext");const a="_7fk4",d="CIKZH",u="GGU9N",h="omP7D",m="fslle",y="J9GAZ";var f;let b=(f=class extends i.Component{constructor(...e){super(...e),this.node=null}UNSAFE_componentWillReceiveProps({focused:e}){const{focused:t,onScrollTo:o}=this.props;o&&this.node&&e&&!t&&o(this.node.offsetTop,this.node.offsetHeight)}setNode(e){this.node=e}render(){const{label:e,value:t,id:o,select:n,allowMultiple:s,disabled:l,style:r,focused:f}=this.props,b=s?i.createElement("div",{className:h},i.createElement(c.X,{id:o,value:t,checked:n,disabled:l,onChange:this.handleClick,label:e})):i.createElement("button",{type:"button",className:u,onClick:this.handleClick},e);return i.createElement("li",{ref:this.setNode,key:o,className:p()(a,l&&m,f&&d,n&&y),"aria-selected":n,role:"option",tabIndex:-1,style:r},b)}handleClick(){const{onClick:e,section:t,index:o,disabled:n}=this.props;n||e(t,o)}},s()(f.prototype,"setNode",[l.Nj],Object.getOwnPropertyDescriptor(f.prototype,"setNode"),f.prototype),s()(f.prototype,"handleClick",[l.Nj],Object.getOwnPropertyDescriptor(f.prototype,"handleClick"),f.prototype),f)},"./app/components/Autocomplete/components/OptionsList/utilities.ts":(e,t,o)=>{function n(e,t,o){return null==e||0===e.length?t||[]:null==t?[{title:o,options:e}]:[{title:o,options:e},...t]}function s(e,t){const o=t.indexOf(e);return-1!==o?t.slice(0,o).concat(t.slice(o+1)):[e,...t]}function i(e,t,o){if(void 0===e||e<0)return null;if(o&&0===e)return"specialOption";let n=e-(o?1:0);for(let e=0;e<t.length;++e){const o=t[e].options.length;if(n<o)return{optionIndex:n,sectionIndex:e};n-=o}return null}o.d(t,{_C:()=>s,aH:()=>n,hA:()=>i})}}]);